# CLAUDE.md

このファイルは Claude Code (claude.ai/code) がこのリポジトリで作業する際のガイダンスを提供します。

## プロジェクト概要

漫画の関係グラフを可視化するVue.js 3フロントエンドアプリケーションです。Cytoscape.jsを使用してインタラクティブなグラフ可視化を行い、バックエンドAPIに接続して漫画作品、作者、雑誌間の関係を検索・表示します。

## 開発コマンド

- `npm run dev` - 開発サーバーをポート3000で起動
- `npm run build` - プロダクション用ビルド
- `npm run preview` - プロダクションビルドのプレビュー

## アーキテクチャ

### 主要技術
- **Vue 3** (Composition API使用)
- **Vite** (ビルドツール・開発サーバー)
- **Cytoscape.js** (cose-bilkentレイアウトでグラフ可視化)
- **Axios** (API通信)

### アプリケーション構造
- **App.vue**: 検索状態とグラフデータを管理するメインコンポーネント
- **components/**: UIエレメント用Vueコンポーネント
  - `Header.vue`: アプリケーションヘッダー
  - `SearchPanel.vue`: 検索機能用左サイドバー
  - `GraphVisualization.vue`: Cytoscape統合メイングラフ表示
- **services/api.js**: 検索、作者、作品、雑誌、ヘルスチェック用APIクライアント

### データフロー
1. ユーザーがSearchPanelコンポーネントで検索
2. App.vueが`searchManga()` API呼び出しで検索処理
3. グラフデータ(ノード/エッジ)がGraphVisualizationコンポーネントを更新
4. Cytoscapeが色分けされたノードタイプでインタラクティブグラフをレンダリング:
   - 作品(緑)、作者(青)、雑誌(オレンジ)

### API統合
- ベースURL: `VITE_API_BASE_URL`環境変数で設定可能
- デフォルトバックエンド: `http://localhost:8000`
- APIリクエストタイムアウト: 30秒
- 日本語ユーザーメッセージでエラーハンドリング

### グラフ機能
- プロパティパネル付きインタラクティブノード選択
- 画面フィット・レイアウトリセットコントロール
- 異なるエッジタイプ: created, same_publisher, mentor_of
- モバイル対応レスポンシブデザイン

## 環境変数
- `VITE_API_BASE_URL`: バックエンドAPI URL (デフォルト: localhost:8000)


# Claude Code Configuration
## YOU MUST: 
- 全てのTODO完了またはユーザー のアクションが必要な際は最後に一度だけ `afplay /System/Library/Sounds/Sosumi.aiff` コマンドを実行して通知する
- 回答は日本語で行ってください
- TODOには必ずブランチ作成・実装内容のテスト・コミット・push・PR作成（まだ作成されていない場合）が含まれるべきです

## issue作成時の注意事項
issue作成時の注意事項をai-rules/ISSUE_GUIDELINES.mdにまとめています
issue作成時は必ず確認して必ずこの内容に従ってissue作成を行ってください。

## Repository 設定
- **リポジトリ名**: manga-graph-frontend
<!-- - **MCP GitHub API**: 常に `xxx` リポジトリを使用
- **Git remote**: xxx -->

## アプリケーションポート設定
以下のポートで各サービスが動作します：

### 開発環境（Docker Compose）
- 以下のポート番号を勝手に変更することは絶対にあってはなりません。
- **フロントエンド**: `http://localhost:3000` (ポート: 3000)
- **バックエンドAPI**: `http://localhost:8000` (ポート: 8000)

## 関数・エンドポイント作成時の注意事項
- 命名規則などを@ai-rules/API_FUNCTION_NAMING.mdにまとめています
- 関数やエンドポイントの作成時には必ず確認し、内容に従って実装を行ってください。

## 修正機能追加の際の作業開始時・終了時に必ず実施すること。必ず毎回全てtodoに含めてください。
- 以下の操作は作業開始時に必ず行ってください
  - **作業開始時**: 必ず専用ブランチを作成する（feat-<機能名>、fix-<修正内容>等）
  - **mainブランチでの直接作業は絶対禁止**: いかなる変更もmainブランチに直接コミットしない
- 以下を必ず作業終了時に実行してください。
  1. 作業内容をコミット
  2. リモートブランチにpush (`git push -u origin <ブランチ名>`)
  3. PR作成 (MCPでPR作成) 
  - @ai-rules/COMMIT_AND_PR_GUIDELINES.mdにガイドラインを記述しています。上記の作業時には必ず確認して必ず内容に従って作業を行ってください。

## 修正の際の注意点
- 修正を行う際には必ず以下のことに順守してください
  - 該当修正によって他の処理に問題がないか慎重に確認を行って作業を行ってください。
  - 他の動作に関しても修正が必要な場合は既存の期待値の動作が正常に起動するように修正してください。

## コミット前に確認すること（必ず実施）
- コミット前には必ず動作確認を行って動作が問題ないかを確認してください
  - 動作確認中にエラーが発見された際はタスクを更新してください
  - コミットする際はエラーがない状態で行ってください

## 開発時の注意点
- Tailwind CSSを優先して使用し、重複スタイルは避けること
- バックエンドAPIはFastAPIで定義し、リクエスト/レスポンススキーマにはPydanticモデルを使うこと
- .envファイル内のキーはUPPER_SNAKE_CASEで記述し、値にクォートは付けないこと


## ファイル作成時の注意点（ファイル作成時必ず確認）
- ファイル作成時に、そのファイルがGithubに挙げられるべきではないと判断した場合には、必ず.gitignoreに指定してください。


## 注意：
すでにポートが使用されている場合（例: 3000番や8000番など）、起動に失敗することがあります。
その場合は該当ポートを使用している場合は、そのポートを使用してください。
別のPJにて使用されている場合は、そのプロセスを特定し、killすることで使用してください。

# 例: ポート8000が使用中の場合
lsof -i :8000
kill -9 <PID>


## 動作確認・テスト時の必須確認事項（コミット前に必ず実施されるべきです）
- テスト・動作確認の際はplaywrightのMCPツールを使用して動作確認を行ってください。
- テスト・動作確認は修正を行って際は必ず行ってください。
- E2Eテストとしてユーザ目線での動作が問題ないかしっかりと確認してください。
開発・テスト時は以下のユーザー情報を使用してください：envファイルに記載されている情報を使用してください。

<!-- メールアドレス: env.MAIL_ADDRESS
パスワード: env.PASSWORD
ユーザー名: env.USERNAME
ユーザーID: env.USER_ID -->

## コード上のコメント
- 英語で作成してください。